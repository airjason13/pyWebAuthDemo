from spidev import SpiDev


cmd_init = [ 0xd3, 0xd3, 0xb7, 0x02, 0x9a, 0x71, 0x4b, 0xb4, 0x31, 0x34, 
             0x0e, 0xa3, 0x8e, 0x51, 0x87, 0xf9, 0x55, 0x34, 0xc6, 0x55, 
             0xb5, 0xf7, 0x17, 0x78, 0x68, 0xef, 0xec, 0x1b ]

#cmd_07 = [ 0xd5, 0x6d, 0xc7, 0x8f, 0x27, 0x20, 0x7f, 0xe4, 0x72, 0x83 ]
cmd_07 = [ 0xd5, 0x6d, 0xc7, 0x8f, 0x27, 0x20, 0x7f, 0xe4, 0x72, 0x83, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 ]

MAX_SPI_SPEED = 1* 1000 * 1000

def spi_xfer_rg215(cmd_data):
    spi = SpiDev()
    spi.open(2, 0)
    spi.max_speed_hz = MAX_SPI_SPEED

    cmd = cmd_data.copy()
    spi.xfer(cmd)
    #print(cmd_data)
    #print(cmd)
    #spi.xfer(cmd_init)
    #spi.xfer(cmd_07)
    #spi.writebytes(cmd_init)

    spi.close
    return cmd


def init_rg215():
    spi_xfer_rg215(cmd_init)

def get_aes_key_from_rg215():
    key = spi_xfer_rg215(cmd_07)
    return key




if __name__ == "__main__":
    print("hello, main")
    init_rg215()
    key = get_aes_key_from_rg215()
    print(key)

    
